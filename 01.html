<!DOCTYPE html>
<html lang="ko">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€êµ¬ê°€ ë§í–ˆë‹¤</title>


    <style>
        body {
            background-image: url;
            color: rgb(71, 83, 216);
        }


        #phone {
            font-size: 10vw;
            width: 12vw;
            height: 12vw;
            border-radius: 50%;
            position: absolute;
            top: 75vh;
            left: 40vw;
            cursor: pointer;
        }


        #win {
            position: absolute;
            top: 5vh;
            left: 50%;
            transform: translateX(-50%) !important;
            font-size: 24px;
            display: none;
            z-index: 10;
        }


        #lose {
            position: absolute;
            top: 5vh;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            display: none;


            z-index: 10;


        }


        #target {
            width: 200px;
            /* JSì˜ (500)ì— ë§ì¶¤ */
            height: 200px;
            /* JSì˜ (300)ì— ë§ì¶¤ */
            background-color: #dc858550;


            position: absolute;
            top: 70px;
            /* JSì˜ top: 100ì— ë§ì¶¤ */
            left: 100px;
            /* JSì˜ left: 300ì— ë§ì¶¤ */
            z-index: -1;
        }


        ;








        @keyframes fadeIn {
            from {
                opacity: 0;
            }


            to {
                opacity: 1;
            }
        }




        #newplanet {
            animation-name: fadeIn;
            animation-delay: 8s;
            animation-fill-mode: both;
            background-color: white;
            background-size: 400px 300 px;
            position: absolute;
            top: 30%;
            left: 10%;




            /*ì´ˆê¸°ìƒíƒœ*/
            opacity: 0;
            font-size: 60px;
            color: rgb(77, 44, 44);
            display: block;
        }
    </style>
</head>


<body>
    <div id="win"></div>
    <div id="lose"></div>
    <div id="phone">ğŸ“±</div>
    <div id="target"></div>

    <h>
        <p>ì§ì„ ë‹¹ê²¨ì„œ ì™¸ê³„ í–‰ì„±ìœ¼ë¡œ ë³´ë‚´ì£¼ì„¸ìš”</p>ì™¸ê³„ì¸ ì‹œì•¼ì— ë“¤ì§€ ì•Šê²Œ ë³´ë‚´ì•¼ í•´ìš”!
    </h>
    <a href="02.html">ë‹¤ìŒ</a>

    <script>
        const phone = document.getElementById('phone');
        const wincaption = document.getElementById('win')
        const losecaption = document.getElementById('lose')
        const target = document.getElementById('target');


        let isDragging = false;
        let startX, startY;


        let attempts = 0;
        let gamedone = false;


        const FORCE_MULTIPLIER = 14;




        // ê³µì´ ì°©ì§€í•  ìµœì†Œ ìµœëŒ€ ê±°ë¦¬
        const MIN_TRAVEL = 200;
        const MAX_TRAVEL = 600;


        const INITIAL_LEFT = '40vw';
        const INITIAL_TOP = '60vh';


        const TARGET_AREA = {
            top: 70, // ëª©í‘œ Y ì‹œì‘ í”½ì…€ (ì˜ˆì‹œ ê°’)
            bottom: 70 + 200, // ëª©í‘œ Y ë í”½ì…€ (ë†’ì´ 300px)
            left: 100, // ëª©í‘œ X ì‹œì‘ í”½ì…€ (ì˜ˆì‹œ ê°’)
            right: 100 + 200 // ëª©í‘œ X ë í”½ì…€ (ë„ˆë¹„ 500px)
        };


        function resetball(isFinalFix = false, finalX, finalY) {
            phone.style.transition = 'none';
            wincaption.style.display = 'none';
            losecaption.style.display = 'none';
            if (!isFinalFix) {
                // ì‹¤íŒ¨ í›„ ì›ì ìœ¼ë¡œ ëŒì•„ê°ˆ ë•Œë§Œ ìœ„ì¹˜ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
                phone.style.transform = 'translate(0, 0)';
                phone.style.left = INITIAL_LEFT;
                phone.style.top = INITIAL_TOP;
            } else {
                // ì„±ê³µ ë˜ëŠ” ìµœì¢… ì‹¤íŒ¨ ì‹œ: transformì„ ì œê±°í•˜ê³  ìµœì¢… ìœ„ì¹˜ì— ê³ ì •í•©ë‹ˆë‹¤.
                phone.style.transform = 'translate(0, 0)';
                phone.style.left = (finalX - phone.offsetWidth / 2) + 'px';
                phone.style.top = (finalY - phone.offsetHeight / 2) + 'px';
            }
        }




        function winorlose(finalX, finalY) {
            //íƒ€ê²Ÿ ì¢Œí‘œ ì•ˆì— ê³µì˜ ì¤‘ì•™ì— ì™”ë‹ˆ?
            const isInsideTarget = (
                finalX >= TARGET_AREA.left &&
                finalX <= TARGET_AREA.right &&
                finalY >= TARGET_AREA.top &&
                finalY <= TARGET_AREA.bottom
            );


            if (isInsideTarget) {
                wincaption.textContent = `ë³´ë‚´ê¸° ì„±ê³µ! ë‹¤ìŒ ì§ì„ ë˜ì ¸ì£¼ì„¸ìš”`;
                wincaption.style.display = 'block';


                gamedone = true;
                resetball(true, finalX, finalY);
                return true;
            }
            else {


                attempts++;
                if (attempts <= 3) {
                    losecaption.textContent = `ë³´ë‚´ê¸° ì‹¤íŒ¨! (${attempts} / 3íšŒ)`;
                    losecaption.style.display = 'block';




                    setTimeout(() => resetball(false), 1000);
                } else {
                    losecaption.textContent = `ë³´ë‚´ê¸° ì‹¤íŒ¨! ê¸°íšŒë¥¼ ëª¨ë‘ ì†Œì§„í–ˆìŠµë‹ˆë‹¤.`;
                    losecaption.style.display = 'block';
                    gamedone = true; // â­ï¸ 4íšŒ ì´ìƒ ì‹¤íŒ¨ ì‹œ ê²Œì„ ì¢…ë£Œ
                    resetball(true, finalX, finalY); // â­ï¸ ë˜ì§„ ìë¦¬ì— ê³ ì •
                }


                return false;
            }
        }




        phone.addEventListener('touchstart', (e) => {
            if (gamedone) return;
            isDragging = true;
            startX = phone.offsetLeft + phone.offsetWidth / 2;
            startY = phone.offsetTop + phone.offsetHeight / 2;


            e.preventDefault();
            phone.style.transition = 'none';
        }, { passive: false });








        document.addEventListener('touchmove', (e) => {
            if (!isDragging || gamedone) return;
            const touch = e.touches[0];
            phone.style.left = (touch.clientX - phone.offsetWidth / 2) + 'px';
            phone.style.top = (touch.clientY - phone.offsetHeight / 2) + 'px';
            e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
        }, { passive: false });












        document.addEventListener('touchend', (e) => {
            if (!isDragging || gamedone) return;
            isDragging = false; //ë“œë˜ê·¸ë




            const touch = e.changedTouches[0];
            let endX = touch.clientX;
            let endY = touch.clientY;




            //ë˜ì§ˆ ë°©í–¥ì„ ê³„ì‚°! = vector
            let directionX = (startX - endX) * FORCE_MULTIPLIER;
            let directionY = (startY - endY) * FORCE_MULTIPLIER;


            // Magnitude=í˜ì˜ í¬ê¸° ê³„ì‚°
            let originalMagnitude = Math.sqrt(
                (directionX * directionX) + (directionY * directionY)
            );


            //ì´ ë‚ ì•„ê°ˆ ê±°ë¦¬ ëœë¤
            const randomTravelRange = MAX_TRAVEL - MIN_TRAVEL;
            const randomMagnitude = Math.random() * randomTravelRange + MIN_TRAVEL;




            //ê³µì´ ë‚ ì•„ê°ˆ ìµœì¢… ë²¡í„° ê³„ì‚°ì„ ìœ„í•´ ì´ˆê¸°í™”
            let movingX = 0;
            let movingY = 0;
            let finalX = phone.offsetLeft + phone.offsetWidth / 2;
            let finalY = phone.offsetTop + phone.offsetHeight / 2;






            // ë‹¹ê¸´ í˜ì´ 0ì´ ì•„ë‹ ë•Œë§Œ ì ìš©
            if (originalMagnitude > 0) {


                // (ëœë¤ í¬ê¸° / ì›ë˜ í¬ê¸°) ë¹„ìœ¨ì„ ê° ë°©í–¥ ë²¡í„°ì— ê³±í•´ í¬ê¸°ë¥¼ ì¡°ì •í•©ë‹ˆë‹¤.
                const scaleFactor = randomMagnitude / originalMagnitude;
                movingX = directionX * scaleFactor;
                movingY = directionY * scaleFactor;


                //ìµœì¢…ë„ì°©ì¢Œí‘œ
                finalX = phone.offsetLeft + movingX + (phone.offsetWidth / 2);
                finalY = phone.offsetTop + movingY + (phone.offsetHeight / 2);


                // íƒ€ê²Ÿ ì¢Œí‘œ ê¸°ì¤€ìœ¼ë¡œ ìŠ¹íŒ¨




                phone.style.transition = 'transform 1s ease-out';
                phone.style.transform = `translate(${movingX}px, ${movingY}px)`;
            }


            setTimeout(() => {
                winorlose(finalX, finalY);
            }, 1000);
        });






    </script>
</body>


</html>